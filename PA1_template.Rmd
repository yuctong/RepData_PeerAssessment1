Reproducible Research: Peer Assesment 1
========================================================

## 1. Loading and preprocessing the data

```{r}
library(reshape2)
data<-read.csv("./data/activity.csv",stringsAsFactor=FALSE)
data$date<-as.Date(data$date)
```

## 2. What is mean total number of steps taken per day?

```{r fig.width=6, fig.height=6}
daily<-dcast(melt(data,id="date",measure.vars="steps"),date~variable,sum)
hist(daily$steps, main="Daily Steps Count", xlab="",ylab="Number of Steps", col="steel blue")

meanNA <- mean(daily$steps,na.rm=TRUE)
medianNA <- median(daily$steps,na.rm=TRUE)
```
The mean is: `r meanNA`  
The median is: `r medianNA`


## 3. What is the average daily activity pattern?
```{r fig.width=6,fig.height=6}
intervalavg<- dcast(melt(data,id=c("date","interval"), measure.vars="steps", na.rm=TRUE), interval~variable,mean)

plot(intervalavg$steps,type="l", main="Daily Activity Pattern", ylab="Steps", xlab="Interval",col="steel blue")

```

## 4. Imputing missing values

### 4.1 Total number of missing values in the dataset
```{r}
sum(is.na(data$steps))
```

### 4.2 Fill up the NA values of steps
I proceed to fill up the NA values of steps with the mean of the interval period, be that 5, 10, 15, etc. creating a new dataset called "datacomplete" that contains the same information of the original dataset.

```{r fig.width=6,fig.height=6}
datacomplete<-data

for (i in 1:nrow(datacomplete)) {
    if (is.na(datacomplete[i,1])) {
      datacomplete[i,1] = intervalavg[match(data[i,3],intervalavg$interval),2]
    }
}
```

### 4.3. Analysis of the missing values
I create an histogram with the data with the completed NA values of the previous step and calculate the mean and median.
```{r fig.height=6, fig.width=6}
dailycomplete<-dcast(melt(datacomplete,id="date",measure.vars="steps"),date~variable,sum)
hist(dailycomplete$steps, main="Daily Steps Count", xlab="",ylab="Number of Steps", col="dark green")

meannoNA <- mean(dailycomplete$steps,na.rm=TRUE)
mediannoNA <- median(dailycomplete$steps,na.rm=TRUE)
```
The mean with completed NAs is: `r meannoNA`  
The median with completed NAs is: `r mediannoNA`

The addition of the mean by interval for the missing values from the dataset does not change the mean, however, it does change slightly the median, being the difference between the new and old `r mediannoNA-medianNA` or `r (mediannoNA/medianNA-1)*100`% which is less than 1% making the difference insignificant.

## 5. Are there differences in activity patterns between weekdays and weekends?
```{r}
datacomplete$day <- weekdays(datacomplete$date)
datacomplete$weekday <- datacomplete$day
for (i in 1:nrow(datacomplete)) {
    if (datacomplete[i,4]=="Saturday") {
        datacomplete[i,5] = "Weekend"
    } else if (datacomplete[i,4]=="Sunday") {
        datacomplete[i,5] = "Weekend"
    } else {
        datacomplete[i,5] = "Weekday"
    }
}
```

```{r}
intervalwkday<- dcast(melt(datacomplete,id=c("date","interval","weekday"), measure.vars="steps"), interval+weekday~variable,mean)
intervalwkday$weekday<- as.factor(intervalwkday$weekday)
library(ggplot2)
qplot(interval,steps,data=intervalwkday, geom="line" )+facet_grid(weekday~.)+geom_smooth(aes(group=1),method="loess")

```